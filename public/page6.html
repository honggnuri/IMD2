<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sejong Bloom - 시작하기</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        /* 이미지 컨테이너 스타일 보완 */
        .img_container {
            width: 100%;
            position: relative;
        }
        .img_container img {
            width: 100%;
            height: auto;
            display: block;
        }
    </style>
</head>

<body>
    <div class="container">
        <div id="step-1" class="img_container">
            <picture>
                <source id="ipad-bg" srcset="/assets/IPAD07.jpg" media="(min-width: 768px) and (orientation: portrait)">
                
                <img id="main-bg" src="/assets/phone07.jpg" alt="Background">
            </picture>
        </div>

        <div class="input-box">
            <div class="input-row" id="row-name">
                <span class="label-text">내이름은</span>
                <input type="text" class="name-input" id="username" placeholder="이름을 적어주세요" autocomplete="off">
            </div>

            <div class="input-row hidden-row" id="row-district">
                <select id="district-select" class="district-input">
                    <option value="" disabled selected>선택해주세요</option>
                    <option value="eojindong">어진동</option>
                    <option value="dodam">도담동</option>
                    <option value="areum">아름동</option>
                    <option value="hamildong">한솔동</option>
                    <option value="naseongdong">나성동</option>
                    <option value="bangok_jiphyeon">반곡·집현동</option>
                    <option value="jochiwon">조치원읍</option>
                    <option value="jeonui_myeon">전의면</option>
                    <option value="yeonseomyeon">연서면</option>
                    <option value="bugangmyeon">부강면</option>
                    <option value="geumnammyeon">금남면</option>
                    <option value="yeongimyeon">연기면</option>
                    <option value="janggunmyeon">장군면</option>
                    <option value="yeondongmyeon">연동면</option>
                    <option value="otherarea">기타 지역</option>
                </select>
                <span class="suffix-text">여기에 살아!</span>
            </div>
        </div>

        <button class="start-btn hidden-row" id="make-flower-btn">
            꽃 만들기
        </button>
    </div>

    <script>
        // DOM 요소 가져오기
        const usernameInput = document.getElementById('username');
        const districtRow = document.getElementById('row-district');
        const districtSelect = document.getElementById('district-select');
        const makeFlowerBtn = document.getElementById('make-flower-btn');
        
        // 이미지 관련 요소
        const ipadBg = document.getElementById('ipad-bg'); // 아이패드용 소스
        const mainBg = document.getElementById('main-bg'); // 모바일용 이미지

        // [설정] 이미지 경로 관리 객체
        // 07: 입력 전 (초기) / 08: 입력 후
        const bgImages = {
            step1: { mobile: '/assets/phone07.jpg', ipad: '/assets/IPAD07.jpg' },
            step2: { mobile: '/assets/phone08.jpg', ipad: '/assets/IPAD08.jpg' }
        };

        // [함수] 배경 이미지 변경 헬퍼
        function changeBackground(stage) {
            // stage는 bgImages.step1 또는 bgImages.step2
            ipadBg.srcset = stage.ipad;  // 아이패드 이미지 변경
            mainBg.src = stage.mobile;   // 모바일 이미지 변경
        }

        // 1️⃣ 이름 입력 시 → 배경 변경 + 동네 선택 노출
        usernameInput.addEventListener('input', function () {
            const val = this.value.trim();

            if (val.length > 0) {
                this.classList.add('filled');
                
                // 이미지 변경 (Step 2: 08번 이미지들로 변경)
                changeBackground(bgImages.step2);

                if (districtRow.classList.contains('hidden-row')) {
                    districtRow.classList.remove('hidden-row');
                    setTimeout(() => districtRow.classList.add('visible'), 10);
                }
            } else {
                // 이름 지웠을 때 다시 되돌릴지 여부는 선택사항 (여기선 유지 혹은 원상복구 가능)
                // 만약 이름을 다 지우면 이미지를 원래대로(07번) 돌리고 싶다면 아래 주석 해제
                
                /*
                this.classList.remove('filled');
                changeBackground(bgImages.step1); 
                // (선택사항) 동네 선택창 숨기기 로직 등 추가 가능
                */
               
               this.classList.remove('filled');
            }
        });

        // 2️⃣ 동네 선택 시 → 버튼 노출
        districtSelect.addEventListener('change', function () {
            if (this.value) {
                this.classList.add('filled');
                makeFlowerBtn.classList.remove('hidden-row');
                setTimeout(() => makeFlowerBtn.classList.add('visible'), 10);
            }
        });

        // 3️⃣ 버튼 클릭 → 정보 저장 → 다음 페이지 이동
        makeFlowerBtn.addEventListener('click', function () {
            const name = usernameInput.value.trim();
            const district = districtSelect.value;

            if (!name || !district) {
                alert('이름과 동네를 모두 입력해주세요!');
                return;
            }

            // localStorage 저장 (영구 저장)
            localStorage.setItem('userName', name);
            localStorage.setItem('userDistrict', district);

            // 다음 페이지로 이동
            window.location.href = 'page7.html';
        });
    </script>
</body>

</html>